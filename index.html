<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

</head>

<body>
    <h2>所有資料表</h2>
    <form id="tableForm" action="/add_table" method="post">
        <label for="">新增資料表</label>
        <div class="row w-50 mb-2">
            <div class="col">
                <input type="text" class="form-control" name="table_name" placeholder="資料表名稱" required>
            </div>
        </div>

        <div id="columnsContainer">
            <div class="row w-50 mb-2 column-row">
                <div class="col">
                    <input type="text" class="form-control" name="col_name[]" placeholder="欄位名稱" required>
                </div>
                <div class="col">
                    <select class="form-select" name="col_type[]" required>
                        <option value="VARCHAR(50)">VARCHAR(50)</option>
                        <option value="INT">INT</option>
                        <option value="FLOAT">FLOAT</option>
                        <option value="DATE">DATE</option>
                        <option value="BOOLEAN">BOOLEAN</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="row w-50 mb-2">
            <div class="col">
                <button type="button" class="btn btn-outline-secondary" onclick="addColumn()">新增欄位</button>
            </div>
            <div class="col">
                <button type="submit" class="btn btn-outline-primary">建立資料表</button>
            </div>
        </div>
    </form>

    <table border="1" cellpadding="8">
        <thead>
            <tr>
                <th>資料表名稱</th>
            </tr>
        </thead>
        <tbody>
            {% for t in tables %}
            <tr>
                <td>{{ t.name }}</td>
                <td>
                    {% for c in t.columns %}
                    {{ c.name }} ({{ c.type }}){% if not loop.last %}, {% endif %}
                    {% endfor %}
                </td>
                <td>
                    <form action="DelTable" method="post">
                        <button class="btn btn-outline-danger" name="del" value="{{ t.name }}"
                            onclick="return confirm('確定刪除?')">刪除</button>
                    </form>
                </td>
            </tr>
            {% endfor %}

        </tbody>
    </table>

    <!-- <form action="/switch_table" method="post" class="mb-3">
        <label for="">選擇資料表</label>
        <select name="table_name" class="form-select w-50 d-inline">
            {% for t in tables %}
            <option value="{{ t.name }}" {% if t.name==current_table %} selected {% endif %}>
                {{ t.name }}
            </option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-outline-primary">切換</button>
    </form> -->

    <!-- <h2>學生資料列表</h2>
    <form action="/add_student" method="post">
        <label for="">新增學生資料</label>
        <div class="row w-50">
            <div class="col">
                <input type="text" class="form-control" name="name" placeholder="名字" required>
            </div>
            <div class="col">
                <input type="text" class="form-control" name="score" placeholder="分數" required>
            </div>
            <div class="col">
                <button class="btn btn-outline-primary">新增</button>
            </div>
        </div>
    </form>
    <form action="/selData" method="post">
        <div class="row w-50 my-3">
            <div class="col">
                <label for="">搜尋內容</label>
                <input type="text" class="form-control" name="select" placeholder="搜尋內容">
            </div>
            <div class="col">
                <label for="">搜尋類型</label>
                <select name="option" class="form-select">
                    <option value="0" {% if option|string=='0' %} selected{% endif %}>id</option>
                    <option value="1" {% if option|string=='1' %} selected{% endif %}>name</option>
                    <option value="2" {% if option|string=='2' %} selected{% endif %}>score</option>
                </select>
            </div>
            <div class="col">
                <button class="btn btn-outline-primary my-4" name="sel">查詢</button>
            </div>
        </div>
    </form> -->
    <!-- <table border="1" cellpadding="8">
        <thead>
            <tr>
                <th>ID</th>
                <th>名字</th>
                <th>分數</th>
            </tr>
        </thead>
        <tbody>
            {% for s in students %}
            <tr>
                <form action="UpdAndDel" method="post">
                    <td>{{ s.id }}</td>
                    <td><input type="text" class="form-control" value="{{ s.name }}" name="name"></td>
                    <td><input type="text" class="form-control" value="{{ s.score }}" name="score"></td>
                    <td>
                        <button class="btn btn-outline-warning" name="upd" value="{{s.id}}">修改</button>
                        <button class="btn btn-outline-danger" name="del" value="{{s.id}}"
                            onclick="confirm('確定刪除?')">刪除</button>
                    </td>
                </form>
            </tr>
            {% endfor %}
        </tbody>
    </table> -->

    <!--  -->
    <h2>新增房間預訂</h2>
    <form action="/add_room" method="post">
        <div class="row w-50 mb-2">
            <div class="col">
                <input type="text" class="form-control" name="room_number" placeholder="房號" required>
            </div>
            <div class="col">
                <input type="text" class="form-control" name="customer_name" placeholder="客戶姓名" required>
            </div>
            <div class="col">
                <input type="text" class="form-control" name="contact_info" placeholder="聯絡方式" required>
            </div>
        </div>
        <div class="row w-50 mb-2">
            <div class="col">
                <label>入住日期</label>
                <input type="date" class="form-control" name="check_indate" required>
            </div>
            <div class="col">
                <label>退房日期</label>
                <input type="date" class="form-control" name="check_outdate" required>
            </div>
            <div class="col">
                <button class="btn btn-outline-primary">新增</button>
            </div>
        </div>
    </form>

    <h2>房間預訂資料列表</h2>

    <form action="/selData" method="post">
        <div class="row w-50 my-3">
            <div class="col">
                <label for="">搜尋內容</label>
                <input type="text" class="form-control" name="select" placeholder="搜尋內容">
            </div>
            <div class="col">
                <label for="">搜尋類型</label>
                <select name="option" class="form-select">
                    <option value="0" {% if option|string=='0' %} selected{% endif %}>Booking_ID</option>
                    <option value="1" {% if option|string=='1' %} selected{% endif %}>Room_Number</option>
                    <option value="2" {% if option|string=='2' %} selected{% endif %}>Customer_Name</option>
                </select>
            </div>
            <div class="col">
                <button class="btn btn-outline-primary my-4" name="sel">查詢</button>
            </div>
        </div>
    </form>

    <table border="1" cellpadding="8">
        <thead>
            <tr>
                <th>Booking_ID</th>
                <th>Room_Number</th>
                <th>Customer_Name</th>
                <th>Contact_INFO</th>
                <th>Check_InDate</th>
                <th>Check_OutDate</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for s in students %}
            <tr>
                <form action="/UpdAndDelRoom" method="post">
                    <td>{{ s.booking_id }}</td>
                    <td><input type="text" class="form-control" value="{{ s.room_number }}" name="room_number"></td>
                    <td><input type="text" class="form-control" value="{{ s.customer_name }}" name="customer_name"></td>
                    <td><input type="text" class="form-control" value="{{ s.contact_info }}" name="contact_info"></td>
                    <td><input type="date" class="form-control" value="{{ s.check_indate }}" name="check_indate"></td>
                    <td><input type="date" class="form-control" value="{{ s.check_outdate }}" name="check_outdate"></td>
                    <td>
                        <button class="btn btn-outline-warning" name="upd" value="{{s.booking_id}}">修改</button>
                        <button class="btn btn-outline-danger" name="del" value="{{s.booking_id}}"
                            onclick="return confirm('確定刪除?')">刪除</button>
                    </td>
                </form>
            </tr>
            {% endfor %}
        </tbody>
    </table>


    <script>
        function addColumn() {
            const container = document.getElementById('columnsContainer');
            const row = document.createElement('div');
            row.className = 'row w-50 mb-2 column-row';
            row.innerHTML = `
        <div class="col">
            <input type="text" class="form-control" name="col_name[]" placeholder="欄位名稱" required>
        </div>
        <div class="col">
            <select class="form-select" name="col_type[]" required>
                <option value="VARCHAR(50)">VARCHAR(50)</option>
                <option value="INT">INT</option>
                <option value="FLOAT">FLOAT</option>
                <option value="DATE">DATE</option>
                <option value="BOOLEAN">BOOLEAN</option>
            </select>
        </div>`;
            container.appendChild(row);
        }
    </script>
</body>

</html>